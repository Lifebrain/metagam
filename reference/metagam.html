<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Meta-analysis of generalized additive models — metagam • metagam</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Meta-analysis of generalized additive models — metagam"><meta name="description" content="Meta-analysis of generalized additive models"><meta property="og:description" content="Meta-analysis of generalized additive models"><meta property="og:image" content="https://lifebrain.github.io/metagam/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metagam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/dominance.html">Dominance Plots</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneity.html">Heterogeneity Plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate.html">Multivariate Smooth Terms</a></li>
    <li><a class="dropdown-item" href="../articles/pvals.html">Simultaneous confidence intervals and p-values</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Lifebrain/metagam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Meta-analysis of generalized additive models</h1>
      <small class="dont-index">Source: <a href="https://github.com/Lifebrain/metagam/blob/v0.4.1/R/metagam.R" class="external-link"><code>R/metagam.R</code></a></small>
      <div class="d-none name"><code>metagam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Meta-analysis of generalized additive models</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">metagam</span><span class="op">(</span></span>
<span>  <span class="va">models</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grid_size <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"iterms"</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"FE"</span>,</span>
<span>  nsim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ci_alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  restrict_range <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-models">models<a class="anchor" aria-label="anchor" href="#arg-models"></a></dt>
<dd><p>List of generalized additive models, each of which has been
returned by <code><a href="strip_rawdata.html">strip_rawdata</a></code>. If the list is named, the names
will be used in the output.</p></dd>


<dt id="arg-grid">grid<a class="anchor" aria-label="anchor" href="#arg-grid"></a></dt>
<dd><p>Grid of values of the explanatory variables over which to compute
the estimated smooth terms. Defaults to <code>NULL</code>, which means that a
grid is set up for the smooth terms defined by the <code>terms</code> argument,
with length given by <code>grid_size</code> for numeric variables and a single
value of each factor variable.</p></dd>


<dt id="arg-grid-size">grid_size<a class="anchor" aria-label="anchor" href="#arg-grid-size"></a></dt>
<dd><p>Numeric value giving the number of elements to use in the
grid of explanatory variables when <code>grid=NULL</code>. When multiple terms
are supplied, each combination of values of explanatory variables are
generated, and the number of grid points becomes <code>grid_size</code> to the
power of the number of terms.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Type of prediction to use. Defaults to <code>"iterms"</code>. Available
options are <code>"iterms"</code>, <code>"link"</code>, and <code>"response"</code>. See the
documentation of <code><a href="https://rdrr.io/pkg/mgcv/man/predict.gam.html" class="external-link">mgcv::predict.gam</a></code> for details. Note that
<code>type="terms"</code> is not supported, since it may result in estimated zero
standard deviation for smooth terms.</p></dd>


<dt id="arg-terms">terms<a class="anchor" aria-label="anchor" href="#arg-terms"></a></dt>
<dd><p>Character vector of terms, smooth or parametric, to be included
in function estimate. Only used if <code>type="iterms"</code>. Defaults to
<code>NULL</code>, which means that the first smooth term when listed in
alphabetic order is taken.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method of meta analysis, passed on to <code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html" class="external-link">metafor::rma.uni</a></code>.
Defaults to <code>"FE"</code>. See the documentation to <code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html" class="external-link">metafor::rma</a></code> for
all available options.</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>Number of simulations to conduct in order to compute p-values and
simultaneous confidence bands for the meta-analytic fit. Defaults to
<code>NULL</code>, which means that no simulations are performed. Only used if
<code>type="iterms"</code>.</p></dd>


<dt id="arg-ci-alpha">ci_alpha<a class="anchor" aria-label="anchor" href="#arg-ci-alpha"></a></dt>
<dd><p>Significance level for simultaneous confidence bands. Ignored
if <code>nsim</code> is <code>NULL</code>, and defaults to 0.05.</p></dd>


<dt id="arg-restrict-range">restrict_range<a class="anchor" aria-label="anchor" href="#arg-restrict-range"></a></dt>
<dd><p>Character vector of explanatory variables to restrict
such that only values within the range for each cohort contribute to the
meta-analysis. Default to <code>NULL</code>, which means that each model
contributes across the whole range specified by <code>grid</code>. Currently not
implemented.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of type metagam.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It is currently assumed that all models have been fit with the same
  smooth terms, although they do not need to have the same basis functions or
  knot placement. Future versions will also include meta-analysis of
  parametric terms in the models.</p>
<p>p-values are truncated below at 1e-16 before computing meta-analytic
  p-values to ensure that no values are identically zero, which would imply
  that the alternative hypothesis be true with no uncertainty.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lifebrain.github.io/metagam/">metagam</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: nlme</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is mgcv 1.9-3. For overview type 'help("mgcv-package")'.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create 5 datasets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">datasets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gamSim.html" class="external-link">gamSim</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Fit a GAM in each dataset, then use strip_rawdata() to remove</span></span></span>
<span class="r-in"><span><span class="co">## individual participant data</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">datasets</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co">## This uses the gam() function from mgcv</span></span></span>
<span class="r-in"><span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x0</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x1</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x2</span>, bs <span class="op">=</span> <span class="st">"cr"</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co">## This uses strip_rawdata() from metagam</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="strip_rawdata.html">strip_rawdata</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Next, we meta-analyze the models.</span></span></span>
<span class="r-in"><span><span class="co">## It is often most convenient to analyze a single term at a time. We focus on s(x1).</span></span></span>
<span class="r-in"><span><span class="va">meta_analysis</span> <span class="op">&lt;-</span> <span class="fu">metagam</span><span class="op">(</span><span class="va">models</span>, terms <span class="op">=</span> <span class="st">"s(x1)"</span>, grid_size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can print some information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meta_analysis</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Meta-analysis of GAMs from  cohorts, using method FE.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Smooth terms analyzed: s(x1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can plot the meta-analytic fit together with the individual fits</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">meta_analysis</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="metagam-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">meta_analysis</span>, ci <span class="op">=</span> <span class="st">"pointwise"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="metagam-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We can also compute p-values and simultaneous confidence intervals, by setting the nsim argument.</span></span></span>
<span class="r-in"><span><span class="co">## For details, see the separate vignette.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="va">meta_analysis</span> <span class="op">&lt;-</span> <span class="fu">metagam</span><span class="op">(</span><span class="va">models</span>, terms <span class="op">=</span> <span class="st">"s(x0)"</span>, grid_size <span class="op">=</span> <span class="fl">30</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meta_analysis</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">meta_analysis</span>, ci <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">meta_analysis</span>, ci <span class="op">=</span> <span class="st">"simultaneous"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Oystein Sorensen, Andreas M. Brandmaier, Athanasia Mo Mowinckel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

