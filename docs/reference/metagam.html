<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Meta-analysis of generalized additive models — metagam • metagam</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Meta-analysis of generalized additive models — metagam" />
<meta property="og:description" content="Meta-analysis of generalized additive models" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metagam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/dominance.html">Dominance analysis</a>
    </li>
    <li>
      <a href="../articles/heterogeneity.html">Heterogeneity analysis</a>
    </li>
    <li>
      <a href="../articles/multivariate.html">Multivariate smooth terms</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/Lifebrain/metagam/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Meta-analysis of generalized additive models</h1>
    <small class="dont-index">Source: <a href='https://github.com/Lifebrain/metagam/blob/master/R/metagam.R'><code>R/metagam.R</code></a></small>
    <div class="hidden name"><code>metagam.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Meta-analysis of generalized additive models</p>
    </div>

    <pre class="usage"><span class='fu'>metagam</span>(
  <span class='no'>models</span>,
  <span class='kw'>grid</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>grid_size</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"iterms"</span>,
  <span class='kw'>terms</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"FE"</span>,
  <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>restrict_range</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>models</th>
      <td><p>List of generalized additive models, each of which has been returned
by <code><a href='strip_rawdata.html'>strip_rawdata</a></code>. If the list is named, the names will be used in the output.</p></td>
    </tr>
    <tr>
      <th>grid</th>
      <td><p>Grid of values of the explanatory variables over which to compute the
estimated smooth terms. Defaults to <code>NULL</code>, which means that a grid is set up
for the smooth terms defined by the <code>terms</code> argument, with length given by
<code>grid_size</code> for numeric variables and a single value of each factor variable.</p></td>
    </tr>
    <tr>
      <th>grid_size</th>
      <td><p>Numeric value giving the number of elements to use in the grid of explanatory
variables when <code>grid=NULL</code>. When multiple terms are supplied, each combination of
values of explanatory variables are generated, and the number of grid
points becomes <code>grid_size</code> to the power of the number of terms.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of prediction to use. Defaults to <code>"iterms"</code>. Available options
are <code>"iterms"</code>, <code>"link"</code>, and <code>"response"</code>. See the documentation
of <code><a href='https://rdrr.io/pkg/mgcv/man/predict.gam.html'>mgcv::predict.gam</a></code> for details. Note that <code>type="terms"</code> is not supported,
since it may result in estimated zero standard deviation for smooth terms.</p></td>
    </tr>
    <tr>
      <th>terms</th>
      <td><p>Character vector of terms, smooth or parametric, to be included in function estimate.
Only used if <code>type="iterms"</code>. Defaults to <code>NULL</code>, which means
that the first smooth term when listed in alphabetic order is taken.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method of meta analysis, passed on to <code><a href='https://rdrr.io/pkg/metafor/man/rma.uni.html'>metafor::rma.uni</a></code>. Defaults to <code>"FE"</code>. See the documentation to
<code><a href='https://rdrr.io/pkg/metafor/man/rma.uni.html'>metafor::rma</a></code> for all available options.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>logical defining whether or not to include the intercept in each smooth
term. Only applies when <code>type = "iterms"</code>.</p></td>
    </tr>
    <tr>
      <th>restrict_range</th>
      <td><p>Character vector of explanatory variables to restrict such that only
values within the range for each cohort contribute to the meta-analysis. Default to <code>NULL</code>,
which means that each model contributes across the whole range specified by <code>grid</code>. Currently
not implemented.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of type metagam.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>It is currently assumed that all models have been fit with the same smooth terms,
although they do not need to have the same basis functions or knot placement. Future versions
will also include meta-analysis of parametric terms in the models.</p>
<p>p-values are truncated below at 1e-16 before computing meta-analytic p-values
to ensure that no values are identically zero, which would imply that the
alternative hypothesis be true with no uncertainty.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>metagam</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>mgcv</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: nlme</span></div><div class='output co'>#&gt; <span class='message'>This is mgcv 1.8-31. For overview type 'help("mgcv-package")'.</span></div><div class='input'>
<span class='co'>## Create 5 datasets</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1234</span>)
<span class='no'>datasets</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gamSim.html'>gamSim</a></span>(<span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))

<span class='co'>## Fit a GAM in each dataset, then use strip_rawdata() to remove</span>
<span class='co'>## individual participant data</span>
<span class='no'>models</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>datasets</span>, <span class='kw'>function</span>(<span class='no'>dat</span>){
  <span class='co'>## This uses the gam() function from mgcv</span>
  <span class='no'>model</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/gam.html'>gam</a></span>(<span class='no'>y</span> ~ <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span>(<span class='no'>x0</span>, <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) + <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span>(<span class='no'>x1</span>, <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>) + <span class='fu'><a href='https://rdrr.io/pkg/mgcv/man/s.html'>s</a></span>(<span class='no'>x2</span>, <span class='kw'>bs</span> <span class='kw'>=</span> <span class='st'>"cr"</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>dat</span>)
  <span class='co'>## This uses strip_rawdata() from metagam</span>
  <span class='fu'><a href='strip_rawdata.html'>strip_rawdata</a></span>(<span class='no'>model</span>)
})

<span class='co'>## Next, we meta-analyze the models.</span>
<span class='co'>## It is often most convenient to analyze a single term at a time. We focus on s(x1).</span>
<span class='no'>meta_analysis</span> <span class='kw'>&lt;-</span> <span class='fu'>metagam</span>(<span class='no'>models</span>, <span class='kw'>terms</span> <span class='kw'>=</span> <span class='st'>"s(x1)"</span>, <span class='kw'>grid_size</span> <span class='kw'>=</span> <span class='fl'>30</span>)

<span class='co'>## We can print some information</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>meta_analysis</span>)</div><div class='output co'>#&gt; Meta-analysis of GAMs from 5 cohorts, using method FE.
#&gt; 
#&gt; Smooth terms analyzed: s(x1) .
#&gt; 
#&gt; Meta-analytic p-values of smooth terms:
#&gt; 
#&gt; |Test                  |s(x1)     |
#&gt; |:---------------------|:---------|
#&gt; |Stouffer's sum of z   |2.682e-47 |
#&gt; |Edgington's sum of p  |2.681e-44 |
#&gt; |Wilkinson's maximum p |1.717e-42 |
#&gt; |Wilkinson's minimum p |7.905e-13 |
#&gt; |logit p method        |8.786e-24 |
#&gt; |Fisher's sum of logs  |3.409e-45 |
#&gt; 
#&gt; </div><div class='input'>
<span class='co'>## We can plot the fit</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>meta_analysis</span>)</div><div class='img'><img src='metagam-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Oystein Sorensen, Andreas M. Brandmaier, Athanasia Mo Mowinckel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


