<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flexible meta-analysis of generalized additive models • metagam</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Flexible meta-analysis of generalized additive models">
<meta property="og:description" content="This package performs meta-analysis of generalized additive
    models and generalized additive mixed models. A typical use case is
    when data cannot be shared across locations, and an overall meta-analytic
    fit is sought. metagam provides functionality for removing individual
    participant data from models computed using the mgcv and gamm4 packages such
    that the model objects can be shared without exposing individual data.
    Furthermore, methods for meta-analysing these fits are provided.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">metagam</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/domination.html">Dominance Plots</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Lifebrain/metagam">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="metagam" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#metagam" class="anchor"></a>metagam</h1></div>
<!-- badges: start -->

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>metagam is an R-package for flexible meta-analysis of generalized additive models (GAMs). Its main application is cases in which raw data are located in multiple locations, and cannot be shared due to ethical or regulatory restrictions. metagam provides functions for removing all individual participant from from GAMs fitted separately at each location, such that the resulting object can be shared to a central location. Next, metagam provides functions for meta-analysing these fitted GAMs using pointwise meta-analysis, as well as plotting and summary methods for analyzing the meta-analytic fits.</p>
<p>This package is under development, so changes to the interface can be expected. Suggestions for improvements and bug reports are warmly welcome, either by filing an <a href="https://github.com/lifebrain/metagam/issues">Issue</a> or opening a <a href="https://github.com/lifebrain/metagam/pulls">Pull Request</a>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the current development version of <code>metagam</code> from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># install.packages("remotes")</span></a>
<a class="sourceLine" id="cb1-2" title="2">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"lifebrain/metagam"</span>)</a></code></pre></div>
</div>
<div id="application-example" class="section level2">
<h2 class="hasAnchor">
<a href="#application-example" class="anchor"></a>Application Example</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(metagam)</a></code></pre></div>
<p>Assume some data of interest are located in three different cohorts. In order to increase statistical power and hence be more able to detect relationships in the data, we would ideally fit a GAM to all three datasets combined, using a model on the form <code>y ~ s(x0) + s(x1) + s(x2)</code>, where <code>y</code> is an outcome of interest and <code>x1</code> and <code>x2</code> are explanatory variables. The smooth functions <code><a href="https://rdrr.io/pkg/mgcv/man/s.html">s()</a></code> allow the outcome to vary nonlinearly as a function of each explanatory variable. When all three datasets are not available in a single location, we cannot fit a GAM using this mega-analytic approach. The metagam package provides a flexible solution to this problem, which here will be illustrated.</p>
<p>We start by simulation three datasets using the <code><a href="https://rdrr.io/pkg/mgcv/man/gamSim.html">gamSim()</a></code> function from mgcv.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(mgcv)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">## simulate three datasets</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">datasets &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/gamSim.html">gamSim</a></span>(<span class="dt">scale =</span> <span class="dv">3</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>))</a></code></pre></div>
<p>In each data location, we assume a GAM with the generic form <code>y~s(x0)+s(x1)+s(x2)</code> is fit to the data. Notably, model parameters like knot locations, number of basis functions, and smoothing method does not need to be identical in each separate fit. Instead, the parameters can be optimized independently to fit the data in each location.</p>
<p>Here is an example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co">## Data location 1</span></a>
<a class="sourceLine" id="cb4-2" title="2">fit1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(y <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x0, <span class="dt">k =</span> <span class="dv">8</span>, <span class="dt">bs =</span> <span class="st">"cr"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x1, <span class="dt">bs =</span> <span class="st">"cr"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x2, <span class="dt">bs =</span> <span class="st">"cr"</span>), </a>
<a class="sourceLine" id="cb4-3" title="3">            <span class="dt">data =</span> datasets[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">## Data location 2, use P-splines for the first and third term</span></a>
<a class="sourceLine" id="cb4-6" title="6">fit2 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(y <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x0, <span class="dt">bs =</span> <span class="st">"ps"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x1, <span class="dt">k =</span> <span class="dv">20</span>, <span class="dt">bs =</span> <span class="st">"cr"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x2, <span class="dt">bs =</span> <span class="st">"bs"</span>), </a>
<a class="sourceLine" id="cb4-7" title="7">            <span class="dt">data =</span> datasets[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">## Data location 3, use maximum likelihood for smoothing</span></a>
<a class="sourceLine" id="cb4-10" title="10">fit3 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(y <span class="op">~</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x0, <span class="dt">bs =</span> <span class="st">"cr"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x1, <span class="dt">bs =</span> <span class="st">"cr"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(x2, <span class="dt">bs =</span> <span class="st">"cr"</span>), </a>
<a class="sourceLine" id="cb4-11" title="11">            <span class="dt">data =</span> datasets[[<span class="dv">3</span>]], <span class="dt">method =</span> <span class="st">"ML"</span>)</a></code></pre></div>
<p>The <code>gam</code> objects <code>fit1</code>, <code>fit2</code>, and <code>fit3</code> contain individual participant data in various forms, and hence there are many cases in which these should not be shared. The function <code><a href="reference/strip_rawdata.html">strip_rawdata()</a></code> from metagam removes all such rawdata. We here illustrate how this function can be applied at each data location in order to obtain a model fit that can be shared.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">## Data location 1</span></a>
<a class="sourceLine" id="cb5-2" title="2">fit_no_raw1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/strip_rawdata.html">strip_rawdata</a></span>(fit1)</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">## Data location 2</span></a>
<a class="sourceLine" id="cb5-5" title="5">fit_no_raw2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/strip_rawdata.html">strip_rawdata</a></span>(fit2)</a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">## Data location 3</span></a>
<a class="sourceLine" id="cb5-8" title="8">fit_no_raw3 &lt;-<span class="st"> </span><span class="kw"><a href="reference/strip_rawdata.html">strip_rawdata</a></span>(fit3)</a></code></pre></div>
<p>Now assume that the objects <code>fit_no_raw1</code>, <code>fit_no_raw2</code>, and <code>fit_no_raw3</code> have been gathered in a single location. We can now perform a meta-analysis of these fits using the <code><a href="reference/metagam.html">metagam()</a></code> function. We gather them in a list:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">models &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">cohort1 =</span> fit_no_raw1, </a>
<a class="sourceLine" id="cb6-2" title="2">               <span class="dt">cohort2 =</span> fit_no_raw2, </a>
<a class="sourceLine" id="cb6-3" title="3">               <span class="dt">cohort3 =</span> fit_no_raw3)</a></code></pre></div>
<p>It is typically most convenient to analyze a single smooth term at a time. We start with the term <code><a href="https://rdrr.io/pkg/mgcv/man/s.html">s(x0)</a></code>, and set <code>grid_size=100</code> to get 100 equally spaced values of <code>x0</code> within the range of values encountered in the three model fits. The summary method prints out some information as well as meta-analytic p-values for the term.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">metafit &lt;-<span class="st"> </span><span class="kw"><a href="reference/metagam.html">metagam</a></span>(models, <span class="dt">grid_size =</span> <span class="dv">100</span>, <span class="dt">terms =</span> <span class="st">"s(x0)"</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(metafit)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; Meta-analysis of GAMs from 3 cohorts, using method FE.</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; Smooth terms analyzed: s(x0) </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; Meta-analytic p-values of smooth terms:</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; Test                         s(x0)</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; ----------------------  ----------</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; Stouffer's sum of z      0.0000143</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; Edgington's sum of p     0.0001186</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; Wilkinson's maximum p    0.0002717</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; Wilkinson's minimum p    0.0002545</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; logit p method           0.0000207</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; Fisher's sum of logs     0.0000191</span></a></code></pre></div>
<p>The default plotting function shows the fits on the separate datasets together with the meta-analytic fit.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(metafit)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>For further documentation and vignettes, please visit the <a href="https://lifebrain.github.io/metagam/">package website</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/Lifebrain/metagam">https://​github.com/​Lifebrain/​metagam</a>
</li>
<li>Report a bug at <br><a href="https://github.com/Lifebrain/metagam/issues">https://​github.com/​Lifebrain/​metagam/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sørensen Øystein <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-0724-3542" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>Brandmaier Andreas <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/lifebrain/metagam"><img src="https://travis-ci.org/lifebrain/metagam.svg?branch=master" alt="Travis build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sørensen Øystein, Brandmaier Andreas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
